<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tournament App v2</title>
  <!--
    Tournament App v2 — Minimal README
    How to run: open index.html in a browser (offline supported). No build step required.
    Enable Supabase: open Setup ▸ Online Room, add URL + anon key, then create or join a room. If missing, online features stay hidden.
    Export PNG/PDF: open Bracket ▸ Share, choose Export PNG or Export PDF. Works offline using client-side rendering.
  -->
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.47.5/dist/umd/supabase.min.js"></script>
</head>
<body>
  <header class="hero">
    <div class="hero__text">
      <p class="eyebrow">Tournament App v2</p>
      <h1>Generate, track, and share brackets quickly.</h1>
      <p class="lede">Offline-first, mobile-friendly, and ready for large events. Start in Setup, then manage results in Bracket.</p>
      <div class="instructions">
        <div>1. Enter teams</div>
        <div>2. Choose format & settings</div>
        <div>3. Generate bracket</div>
        <div>4. Record results</div>
        <div>5. Share / publish room</div>
      </div>
    </div>
    <div class="hero__stats" aria-label="Tournament stats">
      <div class="pill">Participants <strong id="statPlayers">0</strong></div>
      <div class="pill">Rounds <strong id="statRounds">0</strong></div>
      <div class="pill">Matches <strong id="statMatches">0</strong></div>
    </div>
  </header>

  <main class="layout">
    <nav class="tabs" role="tablist" aria-label="Main">
      <button class="tab is-active" data-tab="setup" aria-selected="true">Setup</button>
      <button class="tab" data-tab="bracket" aria-selected="false">Bracket</button>
    </nav>

    <section class="panel" data-panel="setup" role="tabpanel">
      <div class="panel__grid">
        <div class="card">
          <header class="card__header">
            <div>
              <p class="eyebrow">Tournament</p>
              <h2>General settings</h2>
            </div>
            <div class="row">
              <button class="btn ghost" id="btnLoadSample">Load sample</button>
              <button class="btn ghost" id="btnReset">Reset</button>
            </div>
          </header>
          <div class="card__body">
            <div class="field-grid">
              <label>Title
                <input type="text" id="tTitle" placeholder="Friday Night Bracket" />
              </label>
              <label>Format
                <select id="tFormat">
                  <option value="single">Single elimination</option>
                  <option value="double" disabled>Double elimination (coming soon)</option>
                  <option value="round" disabled>Round robin (placeholder)</option>
                </select>
              </label>
              <label>Seeding
                <select id="tSeeding">
                  <option value="as_entered">As entered</option>
                  <option value="random">Randomize</option>
                </select>
              </label>
              <label>Best of (per match)
                <select id="tBestOf">
                  <option value="1">Best of 1</option>
                  <option value="3">Best of 3</option>
                  <option value="5">Best of 5</option>
                </select>
              </label>
              <label>Third place match
                <select id="tThirdPlace">
                  <option value="off">No</option>
                  <option value="on">Yes</option>
                </select>
              </label>
              <label>BYE placement
                <select id="tBye">
                  <option value="auto">Auto balance</option>
                  <option value="end">Place at end</option>
                </select>
              </label>
            </div>
            <label>Participants (one per line)
              <textarea id="names" placeholder="Alice&#10;Bob&#10;Charlie&#10;Dana"></textarea>
            </label>
            <div class="actions">
              <button class="btn" id="btnGenerate">Generate bracket</button>
              <button class="btn ghost" id="btnRegen">Regenerate (clears results)</button>
            </div>
            <div class="hint">
              Duplicate and empty entries are ignored. BYEs are added automatically for the next power of two.
            </div>
          </div>
          <footer class="card__footer">
            <button class="btn ghost" id="btnExport">Export JSON</button>
            <button class="btn ghost" id="btnImport">Import JSON</button>
            <button class="btn ghost" id="btnCopy">Copy JSON</button>
            <button class="btn ghost" id="btnPrint">Print</button>
          </footer>
        </div>

        <div class="card">
          <header class="card__header">
            <div>
              <p class="eyebrow">Utilities</p>
              <h2>Tools</h2>
            </div>
          </header>
          <div class="card__body">
            <div class="utility-row">
              <button class="btn ghost" id="btnCoin">Coin flip</button>
              <button class="btn ghost" id="btnShuffle">Randomize seeding</button>
              <button class="btn ghost" id="btnUndo">Undo</button>
              <button class="btn ghost" id="btnRedo">Redo</button>
            </div>
            <div class="field-grid">
              <label>Match defaults: location
                <input type="text" id="defaultLocation" placeholder="Court 1" />
              </label>
              <label>Match defaults: notes
                <input type="text" id="defaultNotes" placeholder="Optional notes" />
              </label>
              <label>Theme
                <select id="themeSelect">
                  <option value="dark">Dark</option>
                  <option value="light">Light</option>
                  <option value="contrast">High contrast</option>
                </select>
              </label>
              <label>Show seeds
                <select id="toggleSeeds">
                  <option value="on">On</option>
                  <option value="off">Off</option>
                </select>
              </label>
            </div>
            <div class="callout">Need online viewers? Enable a room below. Supabase is optional and ignored when unconfigured.</div>
          </div>
        </div>

        <div class="card">
          <header class="card__header">
            <div>
              <p class="eyebrow">Online Room (optional)</p>
              <h2>Supabase sync</h2>
            </div>
          </header>
          <div class="card__body">
            <div class="field-grid">
              <label>Supabase URL
                <input type="url" id="sbUrl" placeholder="https://xyzcompany.supabase.co" />
              </label>
              <label>Supabase anon key
                <input type="password" id="sbKey" placeholder="anon key" />
              </label>
              <label>Room code
                <input type="text" id="roomCode" placeholder="short code" />
              </label>
            </div>
            <div class="actions">
              <button class="btn" id="btnCreateRoom">Create room</button>
              <button class="btn ghost" id="btnJoinRoom">Join room</button>
              <button class="btn ghost" id="btnLeaveRoom">Disconnect</button>
            </div>
            <div class="hint" id="roomStatus">Rooms are disabled until Supabase details are provided.</div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel is-hidden" data-panel="bracket" role="tabpanel">
      <div class="card bracket-card">
        <header class="card__header card__header--split">
          <div>
            <p class="eyebrow">Live bracket</p>
            <h2 id="viewTitle">No bracket yet</h2>
            <p class="hint" id="viewMeta">Add names in Setup and generate a bracket.</p>
          </div>
          <div class="row">
            <button class="btn ghost" id="btnClearResults">Clear results</button>
            <button class="btn ghost" id="btnCompact">Compact view</button>
            <button class="btn ghost" id="btnZoomOut">-</button>
            <button class="btn ghost" id="btnZoomIn">+</button>
          </div>
        </header>
        <div class="bracket-toolbar">
          <div class="search">
            <input type="search" id="searchInput" placeholder="Search participants" aria-label="Search participants" />
          </div>
          <div class="hint">Click a participant to set the winner. Add scores or notes to each match.</div>
        </div>
        <div class="bracketWrap">
          <div id="bracket" class="bracket" aria-live="polite"></div>
          <div class="empty" id="emptyState">No bracket yet. Generate from the Setup tab.</div>
        </div>
        <footer class="card__footer card__footer--grid">
          <div>
            <p class="eyebrow">Share</p>
            <button class="btn" id="btnExportPng">Export PNG</button>
            <button class="btn ghost" id="btnExportPdf">Export PDF</button>
          </div>
          <div>
            <p class="eyebrow">Match scheduling</p>
            <div class="hint">Edit time/location/notes inside each match card.</div>
          </div>
          <div>
            <p class="eyebrow">Room link</p>
            <button class="btn ghost" id="btnCopyRoom">Copy link</button>
          </div>
        </footer>
      </div>
    </section>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script type="module" src="app.js"></script>
</body>
</html>
